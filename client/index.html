<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style.css">

    <style>
      /* --- Colonne agenda --- */
      #sidebar {
          position: fixed;
          top: 0;
          left: 0;
          width: 250px;
          height: 100vh;
          background: #2b014d;
          padding: 20px;
          color: white;
          z-index: 10;
          overflow-y: auto;
      }

      #sidebar h2 {
          margin-top: 0;
          margin-bottom: 20px;
      }

      #agenda-list li {
          margin-bottom: 10px;
          padding: 10px;
          background: #4a007a;
          border-radius: 5px;
          cursor: pointer;
      }

      /* Ajuster le canvas pour laisser la place Ã  la colonne */
      #canvasBackground {
          position: fixed;
          top: 0;
          left: 250px;
          width: calc(100vw - 250px);
          height: 100vh;
          z-index: -1;
      }
    </style>
  </head>

  <body>

    <!-- ðŸŒŸ Colonne des agendas -->
    <div id="sidebar">
      <h2>Mes agendas</h2>
      <ul id="agenda-list"></ul>
    </div>

    <!-- Canvas Pixi -->
    <canvas id="canvasBackground"></canvas>

    <div id="dialog-container"></div>
    <script type="module" src="/src/main.js"></script>

    <script>
     document.body.addEventListener('htmx:afterSwap', function (event) {
         const dialog = event.detail.elt.querySelector('dialog');
         if (dialog) {
             dialog.showModal();
         }
     });

     document.body.addEventListener("eventSaved", (evt) => {
         const serverData = evt.detail;
         const formattedEvent = {
             ...serverData,
             startDate: new Date(serverData.startDate),
             endDate: new Date(serverData.endDate),
             color: parseInt(serverData.color, 16),
         };

         const appEvent = new CustomEvent('dispatchApp', {
             detail: { type: 'SAVE_EVENT', event: formattedEvent }
         });
         document.body.dispatchEvent(appEvent);
     });

     document.body.addEventListener("eventDeleted", (evt) => {
         const serverData = evt.detail;
         const appEvent = new CustomEvent('dispatchApp', {
             detail: { type: 'EVENT_DELETED', event: serverData.value }
         });
         document.body.dispatchEvent(appEvent);
     });
    </script>

  </body>
</html>
